geom_hline(yintercept = 0.8, linetype='dashed') + ylim(c(0, 1)) +
labs(x = 'Sample Size', y = 'Power (% Simulated Data Set Sig.)',
caption = paste0('n = ', nSim, 'simulations per sample size.')) +
theme_classic() + theme(plot.caption = element_text(size=12, hjust=0))
PowerAnalysis %>% group_by(n) %>%
summarise(power = length(p[p<alpha])/length(p),
se = sqrt((power*(1-power))/length(p))) %>%
ggplot(aes(x = n, y=power)) +
geom_point() +
geom_errorbar(aes(ymin=power-se, ymax=power+se), width=.25) +
geom_line() +
geom_hline(yintercept = 0.8, linetype='dashed') + ylim(c(0, 1)) +
labs(x = 'Sample Size', y = 'Power (% Simulated Data Set Sig.)',
caption = paste0('n = ', nSim, ' simulations per sample size.')) +
theme_classic() + theme(plot.caption = element_text(size=12, hjust=0))
SimData  %>%
group_by(condition, trialintensity, timebin4)
SimData  %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(response[response == 1])/length(response)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %
SimData  %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(response[response == 1])/length(response)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4)
SimData  %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4)
SimData  %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Dots Judged as Blue') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 96),
labels = c('Very Purple', 'Very Blue')) +
theme_bw() +
ylim(c(0.00, 1.00)) +
facet_wrap(condition, nrow = 2) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
SimData  %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Dots Judged as Blue') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 96),
labels = c('Very Purple', 'Very Blue')) +
theme_bw() +
ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 2) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Decreasing Prevalence Condition', 'Stable Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE)))
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Decreasing Prevalence Condition', 'Stable Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Dots Judged as Blue') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 96),
labels = c('Very Purple', 'Very Blue')) +
theme_bw() +
ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Decreasing Prevalence Condition', 'Stable Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Dots Judged as Blue') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 96),
labels = c('Very Purple', 'Very Blue')) +
theme_bw() +
ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1, ncol=1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
##### SETUP ####
# function to load packages or install if not already installed
ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
packages <- c("dplyr", "ggplot2", "grid", 'gridExtra', 'lme4', 'reshape2', 'optimx')
ipak(packages)
rm(packages, ipak)
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Decreasing Prevalence Condition', 'Stable Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Dots Judged as Blue') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 96),
labels = c('Very Purple', 'Very Blue')) +
theme_bw() +
ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1, ncol=1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
SimData$condition
SimData$condition
SimData$condition = ifelse(SimData$condition=='Stable Prevalence Condition', 0, 1)
SimData$condition
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Decreasing Prevalence Condition', 'Stable Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Dots Judged as Blue') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 96),
labels = c('Very Purple', 'Very Blue')) +
theme_bw() +
ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1, ncol=1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
library(dplyr); library(ggplot2)
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Decreasing Prevalence Condition', 'Stable Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Dots Judged as Blue') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 96),
labels = c('Very Purple', 'Very Blue')) +
theme_bw() +
ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1, ncol=1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Decreasing Prevalence Condition', 'Stable Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Dots Judged as Blue') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 96),
labels = c('Very Purple', 'Very Blue')) +
theme_bw() +
ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Stable Prevalence Condition', 'Decreasing Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Dots Judged as Blue') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 96),
labels = c('Very Purple', 'Very Blue')) +
theme_bw() +
ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
SimData$trialintensity
max(SimData$trialintensity
)
library(scales)
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Stable Prevalence Condition', 'Decreasing Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Bodies Judged as Overweight') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 54),
labels = c('Very Thin', 'Very Overweight')) +
theme_bw() +
#ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
PowerAnalysis %>% group_by(n) %>%
summarise(power = length(p[p<alpha])/length(p),
se = sqrt((power*(1-power))/length(p)))
library(dplyr)
PowerAnalysis %>% group_by(n) %>%
summarise(power = length(p[p<alpha])/length(p),
se = sqrt((power*(1-power))/length(p)))
summary(m)
#### VISUALIZE LAST SIMULATION ####
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Stable Prevalence Condition', 'Decreasing Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Bodies Judged as Overweight') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 54),
labels = c('Very Thin', 'Very Overweight')) +
theme_bw() +
#ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
library(dplyr); library(ggplot2)
#### VISUALIZE LAST SIMULATION ####
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Stable Prevalence Condition', 'Decreasing Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Bodies Judged as Overweight') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 54),
labels = c('Very Thin', 'Very Overweight')) +
theme_bw() +
#ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
summary(m)
SimData$size
#### VISUALIZE LAST SIMULATION ####
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Stable Prevalence Condition', 'Decreasing Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Bodies Judged as Overweight') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 54),
labels = c('Very Thin', 'Very Overweight')) +
theme_bw() +
#ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
library(dplyr)
library(reshape2)
library(ggplot2)
#### VISUALIZE LAST SIMULATION ####
SimData  %>%
mutate(condition = factor(ifelse(SimData$condition == 0,
'Stable Prevalence Condition',
'Decreasing Prevalence Condition'),
levels = c('Stable Prevalence Condition', 'Decreasing Prevalence Condition'))) %>%
mutate(trialintensity = size/10) %>%
mutate(trial = as.numeric(trial)) %>%
mutate(timebin4 = as.factor(apply(as.matrix(trial), 2, cut, c(seq(0,800,200)), labels=FALSE))) %>%
group_by(condition, trialintensity, timebin4) %>%
summarise(pBlue = length(simresp[simresp == 1])/length(simresp)) %>%
rename(colour = trialintensity, trialbins = timebin4) %>%
filter(trialbins == 1 | trialbins == 4) %>%
ggplot(aes(x = colour, y = pBlue, color = trialbins)) + geom_point() +
geom_line(stat="smooth",method = "glm", method.args = list(
family="binomial"), se=FALSE,size=1.8,alpha=.7) +
ylab('% Bodies Judged as Overweight') + xlab('') +
scale_colour_manual(labels=c("Initial 200 trials", "Final 200 trials"), name=NULL,values=c("#0066CC", '#990000')) +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(5, 54),
labels = c('Very Thin', 'Very Overweight')) +
theme_bw() +
#ylim(c(0.00, 1.00)) +
facet_wrap(~condition, nrow = 1) +
theme(axis.ticks.x = element_blank(), plot.title = element_text(hjust = 0.5),
legend.position = 'none',
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.title.y = element_text(size = 12),
strip.background = element_blank(),
strip.placement = "outside",
strip.text = element_text(size = 12))
stiminfo = read.csv("stiminformation.csv")
View(stiminfo)
SimData$bmi[SimData$stim==stiminfo$Name] = stiminfo$BMI
SimData$stim
View(SimData)
sub(".*/", "", SimData$stim)
sub(".*/ *(.*?) *.jpg*", "\\1", SimData$stim)
SimData$x = sub(".*/ *(.*?) *.jpg*", "\\1", SimData$stim)
for(i in stiminfo$BMI){
SimData$bmi[SimData$x==i] = stiminfo$BMI[stiminfo$Name==i]
}
for(i in stiminfo$Name){
SimData$bmi[SimData$x==i] = stiminfo$BMI[stiminfo$Name==i]
}
